<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
     <meta name="google-signin-client_id" content="958654628278-imi7jt4jt651rnjspv2limla0ur34nhk.apps.googleusercontent.com">
    <!-- <meta name="google-signin-client_id" content="958654628278-2igl5305b2tc7345fnu6l8r9kera17sk.apps.googleusercontent.com"> -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/css/toastr.css" rel="stylesheet"/>
    <link rel="stylesheet" href="assets/style/login.css">
    <link rel="stylesheet" href="assets/style/description.css">
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script> -->
    <link href='https://fonts.googleapis.com/css?family=ABeeZee' rel='stylesheet'>
  <style>
    body { font-family: 'ABeeZee'; }
  </style>
    <!-- <script src="https://apis.google.com/js/platform.js" async defer></script> -->
    <!-- <script src="https://accounts.google.com/gsi/client" async defer></script> -->
    <!-- <script src = "https://accounts.google.com/gsi/client " async defer></script> -->
    <!-- <script src="../main.js" type="text/javascript"></script> --></head>

<body>

    <div class="mobile-cont" id="m-cont">
        <span>Experience is best when viewed on Desktop.</span>
        <div class="skip-btn" id="start-btn">Start anyway</div>
    </div>

    <div class="container right-panel-active" id="container">

        <div class="form-container sign-up-container">
            <form action="" method="post" style="align-items: start;">
                <div class="w-100" style="align-items: start;">
                    <h1 style="padding-top: 15px">Welcome back</h1>

                    <label>Email</label>
                    <input type="email" class="form-control" name="email" id="email" placeholder="eg. janedoe@gmail.com"
                        required>

                    <label>Password</label>
                    <input type="password" class="form-control" id="password" name="password" placeholder="Password"
                        required>

                    <button type="button" id="login">Login</button>
                 
              <div id="user-info-wrapper">
                <img width="50" />
                <p></p><p></p><p></p>
              </div>
                </div>

                <p class="d-flex justify-content-center position-absolute align-items-center justify-items-center justify-self-center align-self-center align-content-center text-align-center"
                    style="bottom:0">
                    Don't have an account? <a href="../register/">Register </a>
                </p>
            </form>


        </div>

        <div class="overlay-container">
            <div class="overlay">

                <div class="overlay-panel overlay-left bg-dark">
                    <img src="assets/images/video-camera-iso-color.png" alt="movie-1" />
                    <div class="">
                        <h4>“Painting is just another way of keeping a diary.”</h4>
                        <span>~ Pablo Picasso</span>
                    </div>
                </div>
                <div class="overlay-panel overlay-right">
                    <!-- <img src="assets/images/illus.svg" alt="movie-2" /> -->
                    <!-- <div class="quote-cont">
                        <h4>“Painting is just another way of keeping a diary.”</h4>
                        <span>~ Pablo Picasso</span>
                    </div> -->
                </div>



            </div>
        </div>
    </div>

    <div class="powered-by-cont row">
        <a href="https://wowexp.ai" target="_blank">
            <p>Powered by <span><img src="../wow-logo.png" alt=""></span></p>
        </a>
    </div>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="assets/script/jquery-3.6.0.js"></script>
    <!-- <script src="../assets/js/mobile-detect.js"></script> -->
    <script src="assets/script/bootstrap.bundle.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.0.1/js/toastr.js"></script>
    <script type="text/javascript">
        const urlParams = new URLSearchParams(window.location.search)
        console.log("urlParams",urlParams.get('email'),urlParams.get('name'),urlParams.get('picture'))
        if (urlParams.get('id')) {
          document.querySelector('#link').style.display = 'none'
          document.querySelector('img').src = urlParams.get('picture')
          document.querySelectorAll('p')[0].innerHTML = `Hi, ${urlParams.get('given_name')}!`
          document.querySelectorAll('p')[1].innerHTML = `Full name: ${urlParams.get('name')}`
          document.querySelectorAll('p')[2].innerHTML = `Email: ${urlParams.get('email')}`
        } else {
          document.querySelector('#user-info-wrapper').style.display = 'none'
        }
    
    
        async function getClientId() {
          const redirectUri = 'http://localhost:5001/oauth2callback'
          const scope = 'profile email openid'
          const responseType = 'code'
    
          const response = await fetch('clientId')
          const json = await response.json()
          console.log("json",json)
          document.querySelector('#link').href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${json.clientId}&redirect_uri=${redirectUri}&scope=${scope}&response_type=${responseType}&access_type=offline&include_granted_scopes=true`
        }
        getClientId()
      </script>
    <script>
        // function onSignIn(googleUser) {
        //   console.log('Logged in as: ' + googleUser.getBasicProfile().getName());
        // }
        // function onFailure(error) {
        //   console.log(error);
        // }
        // function renderButton() {
        //   gapi.signin2.render('my-signin2', {
        //     'scope': 'profile email',
        //     'width': 240,
        //     'height': 50,
        //     'longtitle': true,
        //     'theme': 'dark',
        //     'onsuccess': onSignIn,
        //     'onfailure': onFailure
        //   });
        // }
      </script>
    
      <!-- <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script> -->
      
    <!-- <script type="text/javascript">
      $(document).ready(function() {
        toastr.options.timeOut = 1500; // 1.5s
        toastr.info('Page Loaded!');
        $('#login').click(function() {
           toastr.success('Click Button');
        });
      });
    </script> -->
    <script>
        function login() {
            var email = document.getElementById('email').value
            var password = document.getElementById('password').value
            console.log("name++++", email, password)
            axios.post('/api/login', { email: email, password: password }).then(async (response) => {
                console.log("response", response.data)
                var token = response.data.token
                var user = response.data.user

                localStorage.setItem("name", user.name);
                localStorage.setItem("email", user.email);
                localStorage.setItem("uid", user.user_id);
                localStorage.setItem("usertype", user.user_type);
                localStorage.setItem("company_id", user.company_id);
                localStorage.setItem("image", user.avatar);
                localStorage.setItem("token", token);

                window.location.href = "../dashboard/";
            }).catch(async (errors) => {
                $(document).ready(function() {
        // toastr.options.timeOut = 1000000; 
        toastr["error"]('you are not approve yet!');
  
        $('#login').click(function() {
            toastr.options = {
  "closeButton": true,
  "newestOnTop": false,
  "progressBar": true,
  "positionClass": "toast-top-center",
//   "preventDuplicates": false,
//   "onclick": null,
   "showDuration": "3000000",
//   "hideDuration": "1000",
   "timeOut": "50000000",
//   "extendedTimeOut": "1000",
//   "showEasing": "swing",
//   "hideEasing": "linear",
//   "showMethod": "fadeIn",
//   "hideMethod": "fadeOut"
}
        //    toastr.info('Click Button');
        //    toastr.options.closeButton = true;
        // toastr.options.positionClass=toast-top-center;
        });
      });
                console.log("err--", errors)

            })
        }
        
        document.getElementById("login").addEventListener("click", login);
      
//         function HandleGoogleApiLibrary(googleUser) {
//                 // Load "client" & "auth2" libraries
//              var auth2 =   gapi.load('client:auth2', {
//                     callback: function (res) {
//                         // Initialize client & auth libraries
//                         gapi.client.init({
//                             apiKey: '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',
//                             client_id: '958654628278-2igl5305b2tc7345fnu6l8r9kera17sk.apps.googleusercontent.com',
//                             scope: "",
//                             // scope: 'https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.me'
//                         }).then(
//                             function (success) {

//                                 console.log("Yaaay",success,res,googleUser.credential);
                                
//             axios.post('/api/google',{
//                 accessToken:googleUser.credential,CLIENT_ID:googleUser.clientId
               
//             }).then((response)=>console.log("response",response)).catch((err)=>console.log(err))
                             
     
//                             },
//                             function (error) {
//                                 console.log("Nope");
//                                 console.log(error);
//                             }
//                         );

//                     },
                  
//                 });
//             }



//         function onSignIn(googleUser) {
//             console.log("hii",googleUser)
//             if (auth2.isSignedIn.get()) {
//   var profile = auth2.currentUser.get().getBasicProfile();
//   console.log('ID: ' + profile.getId());
//   console.log('Full Name: ' + profile.getName());
//   console.log('Given Name: ' + profile.getGivenName());
//   console.log('Family Name: ' + profile.getFamilyName());
//   console.log('Image URL: ' + profile.getImageUrl());
//   console.log('Email: ' + profile.getEmail());
// }
        
//             axios.post('/api/google',{
//             token:googleUser.credential,CLIENT_ID:googleUser.clientId
               
//             }).then((response)=>console.log("response",response)).catch((err)=>console.log(err))
        
// }

    </script>
     
      
<!-- <script src="https://apis.google.com/js/platform.js" async defer></script> -->
</body>

</html>